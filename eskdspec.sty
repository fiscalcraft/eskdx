% Copyright 2006 Konstantin Korikov <lostclus@ua.fm>
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2003/12/01 or later.
%
% This work has the LPPL maintenance status "maintained".
% 
% This Current Maintainer of this work is Konstantin Korikov.
%
% This work consists of all files listed in manifest.txt.
%

%
% This is automaticaly generated file, do not edit it.
%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{eskdspec}[2010/01/14 v0.98 Specification GOST 2.106.95]

\RequirePackage{eskdlang}
\RequirePackage{eskdstamp}
\RequirePackage{rotating}
\RequirePackage{array}
\RequirePackage{longtable}

\newcommand{\ESKDdrawSpecification}{
  \put(\ESKDltu{\ESKDframeX},\ESKDltu{\ESKDframeY}){%
    \begin{picture}(0,0)
    \ESKD@tmpdimb=\ESKDframeH
    \ESKD@tmpdima=\ESKD@style@sh@formII         % высота штампа
    \ESKD@tmpdimc=8mm                           % высота строки
    \advance\ESKD@tmpdimb -\ESKD@tmpdima
    \advance\ESKD@tmpdimb -15mm                 % высота заголовка таблицы
    \divide\ESKD@tmpdimb by \ESKD@tmpdimc
    \ESKD@tmpcnta=\ESKD@tmpdimb                 %tmpcnta = (\paperheight-\ESKD@margin@t-\ESKD@margin@b-\ESKD@tmpdima-15mm)/8mm    %количество строк
    \ESKD@tmpdimb=\ESKD@tmpdimc
    \multiply\ESKD@tmpdimb by \ESKD@tmpcnta     % высота таблицы без заголовка с учётом целого числа строк
    \advance\ESKD@tmpdimb 15mm                  % высота таблицы с заголовком в \ESKD@tmpdimb
    \ESKD@tmpdima=\ESKDframeH                   % \paperheight-\ESKD@margin@t-\ESKD@margin@b
    \advance\ESKD@tmpdima -\ESKD@tmpdimb        % координата нижней границы таблицы в \ESKD@tmpdima
    \linethickness{\ESKDlineThick}              % толщина линии - толстая
    \put(6,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}      % вертикальная линия первого столбца
    \put(12,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}     % второго столбца
    \put(20,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}     % третьего столбца
    \put(90,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}     % четвёртого столбца
    \put(153,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}    % пятого столбца
    \put(163,\ESKDltu{\ESKD@tmpdima}){\line(0,1){\ESKDltu{\ESKD@tmpdimb}}}    % шестого столбца
    \ESKD@tmpdimb=\ESKDframeH                                                 % высота зоны печати
    \advance\ESKD@tmpdimb -15mm                                               % отступаем на высоту заголовка
    \put(0,\ESKDltu{\ESKD@tmpdimb}){\line(1,0){\ESKDltu{\ESKDframeW}}}        % чертим горизонтальную линию
    \linethickness{\ESKDlineThin}                                             % толщина линии - тонкая
    \multiput(0,\ESKDltu{\ESKD@tmpdima})(0, 8){\the\ESKD@tmpcnta}{%           % чертим горизонтальные линии таблицы
      \line(1,0){\ESKDltu{\ESKDframeW}}}
    \end{picture}}}

\newenvironment{ESKDspecification}{%
\ESKDputOnStyle{formII}{specification}{\ESKDdrawSpecification}
\ESKDputOnStyle{formIIab}{specification}{\ESKDdrawSpecification}
\begin{ESKDzeroPadding}%
\setlength{\tabcolsep}{0.5mm}%
\setlength{\LTpre}{0mm}%
\setlength{\LTpost}{0mm}%
\setlength{\LTleft}{0mm}%
\setlength{\LTright}{\fill}%
\newcolumntype{s}{>{\ESKDfontTabBody}c}%
\newcolumntype{n}{>{\parbox[c][8mm][c]{1mm}{%
  \rule{0mm}{0mm}}\ESKDfontTabBody}l}%
\noindent%
\begin{longtable}{ssssnss}
\parbox[c][15mm][c]{5mm}{\centering\begin{sideways}\ESKDfontTabHead%
\ESKDspecColumnIname\end{sideways}}&
\parbox[c][15mm][c]{5mm}{\centering\begin{sideways}\ESKDfontTabHead%
\ESKDspecColumnIIname\end{sideways}}&
\parbox[c][15mm][c]{7mm}{\centering\begin{sideways}\ESKDfontTabHead%
\ESKDspecColumnIIIname\end{sideways}}&
\parbox[c][15mm][c]{69mm}{\centering\ESKDfontTabHead%
\ESKDspecColumnIVname}&
\parbox[c][15mm][c]{61mm}{\centering\ESKDfontTabHead%
\ESKDspecColumnVname}&
\parbox[c][15mm][c]{9mm}{\centering\begin{sideways}\ESKDfontTabHead%
\ESKDspecColumnVIname\end{sideways}}&
\parbox[c][15mm][c]{21mm}{\centering\ESKDfontTabHead%
\ESKDspecColumnVIIname}\endhead}{%
\end{longtable}%
\end{ESKDzeroPadding}%
\ESKDremoveFromStyle{formII}{spec}%
\ESKDremoveFromStyle{formIIab}{spec}}

